#include <opencv2/opencv.hpp>
#include "Encoder.h"
#include "Decoder.h"
#include "Wavelet.h"
#include "SpaRSA_noSI.h"
#include "Options.h"
#include <cmath>

int main(int argc, char** argv) {

//	cv::Mat phi = (cv::Mat_<float>(26,64) << 0.140334099125546,-0.0171582585653223,0.00295923147104734,-0.0749467996028025,0.111427540247658,-0.0427636128466220,0.109817961679164,-0.147626279924071,-0.172255381785184,-0.0338160385466870,0.0660909752867701,-0.00766241082374398,-0.0185524785329608,-0.0159752530685457,0.144603306460044,0.0106247462507225,0.0766399941296997,0.00313597312859535,-0.0361220474111560,-0.0294692997697132,-0.00423109807226353,-0.0889628785035123,-0.143836367767104,-0.0498482807010659,-0.0990174885263251,-0.285674480320050,-0.172954248768873,0.246522272329555,-0.163784321611775,0.0981485284661350,-0.0849382466963773,0.0743563144152133,-0.0684579335617716,0.0110474981617423,0.0792620176783707,-0.0280746307492380,0.0215888138566823,-0.0996750813084964,-0.0472080913026705,-0.135427707290076,0.124853946949053,0.145697907736803,0.260665416788865,-0.0873661109779841,-0.00996274202962790,0.0189244082127272,0.169289666488317,-0.0268483601240803,0.113281265908151,0.0436844714531462,0.138981650350467,-0.0701673439220227,0.0924383556664842,-0.0525339044850776,-0.0435027635657828,0.0360689772643379,0.0695843925168071,0.00830114692254912,-0.0180987735650077,0.140607120724503,-0.00411822297973965,0.0378687654063436,-0.0203087903037841,-0.000630620148060471,-0.0711054166210607,-0.189005688950871,-0.117881589714618,-0.0990062897010510,0.0583489614485132,-0.0629329056066200,-0.0942839740904117,0.0416869788061647,0.0902001332758599,0.0573356881262081,-0.0241341686881369,-0.129877402676427,-0.150159789279091,0.00405181958840628,-0.0375702176389089,0.0504916340884810,-0.00706159603327294,0.196855706364339,0.0869339381771958,0.0630689134891613,0.150378158888187,0.00570252824853087,0.0147031799939863,0.0490677800344301,-0.135472202953350,-0.0960745302531764,0.0371835371433691,0.0643088901381021,-0.0183231837435291,-0.0874658100972959,-0.0577825578957325,-0.0366510165515308,-0.123149061528338,0.0468547741528132,0.0446124299552339,0.156358241804207,0.00852000778952079,0.00691098724086462,0.170391382276172,-0.118162175102902,0.132793144592475,-0.179283562152479,-0.0556887419879950,0.160684950280150,-0.00343156277462298,0.0774991862345281,0.0138557228897340,-0.000768680887837840,0.0548087350503954,0.0876317821794877,0.0495408392435100,0.0759948160066272,-0.0840557854266130,-0.0392238239251827,-0.00406612336702209,0.0947837874696544,-0.112972450130353,-0.0840733579919365,-0.0864267387491490,0.0465342596234288,0.0312411297157022,-0.0887582776462804,-0.0731047981635120,0.00823660294816658,0.0615734810484218,-0.0742098620812048,0.0996571794688511,0.223268938946498,-0.00599852413987662,-0.103786687765748,0.0825306894512111,-0.107201559929116,0.0761656801101730,0.0729846583298354,0.139326565351010,0.0169866710714733,0.0537048109292021,-0.00563768458662836,0.0520990413330089,0.0364863572672421,0.0794148081027337,-0.00611773354671983,-0.0263129586586120,0.0280551450713954,-0.0450525760685071,0.0530588134951197,0.0332575221011292,-0.0492126930794026,-0.0970387180860446,-0.126080335162226,0.0354205694961049,-0.0683298586154670,0.0238982825758838,-0.161647786344147,-0.108664073244372,0.169014504707758,-0.0341386426049693,-0.0841517371149276,-0.0354346353851892,0.133517881897727,-0.0734037382785479,0.186201514374780,-0.0155782294791695,-0.130270856646234,0.0645567273191481,-0.0397090672333678,-0.00414359266392622,-0.0330958329482824,0.00778600837389618,0.0171833144992663,-0.0265639209257502,0.0447806328562051,-0.0253386290168419,0.0952066348121693,-0.0371535651342976,0.00591045903498653,0.0702508309218860,-0.116896210279901,-0.0411666082679119,0.0855584083003952,-0.0516712182688548,0.103643286420591,-0.139030149804508,0.0234068777525395,-0.111086525103335,-0.0559222359953725,-0.0735375686467522,0.0826653088573605,0.0738120630514405,0.119730354386115,0.0309517794836888,0.146326696771081,-0.0172552791081963,-0.0169917333080064,0.0309642944563710,0.00585042901101359,0.000102714638937191,-0.0897091915326627,-0.0425092401684207,-0.0726811439736108,-0.0104119961441938,0.0540349076626903,-0.00555001268805534,-0.0872359300613134,0.0162372420243755,-0.0448414474051566,0.101087889163274,0.0365583389681858,-0.000252345209758356,-0.120342057158954,-0.0200597765734019,-0.0791175710035979,-0.125137864537962,-0.0896656271280415,0.00840945812530933,0.0739486751449561,-0.0576973511486092,0.122373535740160,-0.0239501601077690,-0.0345508930399656,0.0464557090334287,0.0754874335234212,-0.0454181767318226,0.0144966009087260,-0.0311349886461961,-0.0632725682474549,-0.0215446917788568,-0.00368253029501230,0.0433767824181971,0.0208590491555555,0.237148191595399,-0.128316963447278,-0.0697963866832179,-0.0366716324541071,-0.0441972477472543,0.106353455084442,0.0528576208503943,0.0686637629276646,-0.0136069786206364,-0.144902742884437,0.00631356286878151,-0.0759716556511222,0.00671286803372017,0.0238777172645837,-0.0547482431856005,0.153362256639854,-0.0327268079738264,-0.0347894671861778,-0.0915731069058837,-0.0924285782437098,0.0440085141514813,0.0586472527457415,-0.0215415785548852,-0.0947660343626903,-0.0264339522588742,0.0271825245688316,-0.0192338657269382,-0.0242246147633374,-0.00256377152649188,0.0576606590774292,-0.00626118422326656,-0.0416370912089027,0.0289482551949323,-0.00832976985116597,0.0617976266320549,0.00966241032148566,-0.178717608840040,0.0671369892536071,0.0257024595348685,0.0208428273185052,-0.0469890237630547,-0.0510076411894230,0.0813055312401712,0.0307231383936802,-0.101550458872251,-0.0361798009618863,0.00526534589179060,-0.0188503343820901,0.0439011126794632,-0.0997312517098043,0.0421813311745214,-0.00554431767858299,-0.0795450994184242,0.0361669281636585,0.134639254275226,0.0343959484684164,0.0703896159517778,-0.0249930175000162,-0.0154480769554724,-0.0247943158308041,-0.0793374390714155,-0.0544036763174202,-0.0518067209906459,-0.0738195582693531,-0.101354095015082,-0.0546842626909631,0.125773137864284,0.0316835752332973,0.0633277214660199,0.0461402845711971,-0.0217022274681324,-0.199743554620820,-0.0243243489476730,-0.214319638303373,-0.0683849068890025,-0.124892838860296,-0.0812085307167027,-0.0560741454179888,0.0473143749366106,-0.0328535992759755,-0.0195466823487244,-0.192360448258990,-0.0377385264789036,0.0446986069602316,0.204674365045935,-0.0309564867051890,0.0190627225743970,0.0849371247126261,0.00202319095932901,-0.111114614581493,-0.0267911818108925,0.135240581332054,0.0161266456107081,0.0289082900806960,-0.219758527535546,0.0121114022110740,0.0587547505477311,0.0297173416642660,0.0238337978869435,0.160337828258803,-0.0868089827369319,-0.0580889368996315,0.00998299691309762,0.0217262847028364,0.0859634776780688,0.0127280812845219,0.0132413463406985,-0.0160728216106727,0.178927413564308,-0.0142205154704914,-0.0363497897766346,-0.0287569527171118,0.0956574580525749,-0.125906557654743,-0.00630382602078301,0.0396793960229269,-0.0252513256486562,-0.100977338087150,0.158965952858839,-0.102177025778545,-0.0593253895544095,0.101838031981448,-0.0424841615394408,0.103102798222235,-0.0700333462876607,0.116155972101789,0.0658404492648120,-0.112779568566993,0.0488786453633562,0.0825989959330687,0.000559647098047842,0.00320166177583354,0.118200740911988,0.0350942480383600,-0.157396416505414,-0.0498843231802437,0.0213122385821342,-0.0250872581990488,0.0684268861678363,-0.0456071411428196,-0.169658474937328,0.0556637269189746,0.0426904275407620,0.105435289303327,-0.0473065769888761,-0.105681919605130,0.00686500623902409,0.0293408409299695,-0.0701649420898348,0.143178290257375,-0.103047018719518,0.0109645568483866,-0.0231573435880553,-0.0764972891631835,0.00203696466345878,-0.0220108855143351,-0.138332715067846,0.0956921865481956,0.0513688613002602,-0.0257973215219186,0.00752967894910892,-0.0799608774901719,0.0436892160889390,0.0275792706129271,0.0541388615609031,-0.0533793566831214,0.0388866470186959,0.00619118032103209,-0.0461608574271127,-0.144838956216782,0.124179745819247,-0.0830439255197181,-0.208554384370980,0.0361803939435232,-0.0325278606103365,0.171862108002939,0.0857762764916256,0.0634135408006789,-0.0829349004663693,-0.0321078161506697,-0.0408726762224113,-0.0552306766338200,-0.0103312072235444,0.00351256415991401,0.104886832020895,-0.101337915168982,0.0739666141736613,0.107199281197062,-0.0842318582840361,-0.128610930943891,-0.0731992493778650,0.0545387112754370,-0.0951463800918236,0.0933318422149084,0.0606769078322582,-0.0322291464484733,0.187885338131850,-0.0426748524024970,-0.207468596981759,0.0796813383669747,0.0667054833357568,0.101275925490874,0.0234807815671292,-0.0959100278055680,-0.00322114919379255,-0.00700334058975441,0.00958793338984447,0.0842913732751280,-0.0231552875062084,0.0322907729560673,0.158297366342903,-0.144551410603770,0.0478145224733799,-0.00449305340385731,-0.101465649305142,0.126987240554047,-0.154698379280662,-0.0156035586604774,0.00453346980376746,-0.0940640651104653,-0.00747230493213701,0.0889254934320901,-0.193785699902260,0.0266772433891230,0.0778659610560145,-0.0254785034660883,-0.131090616542665,0.159496222824383,-0.00485129433851001,0.0156400372473172,0.00898577541656336,-0.0537914256969375,0.0156074194998184,-0.0671830990433839,0.0914042941501018,-0.00331749654169892,-0.0450755864750892,-0.0842019216957431,-0.120293282217393,-0.0505380899994696,-0.0502549248498515,-0.0687577835556929,0.0142626561984619,-0.0902076797561651,-0.0362202380215946,-0.103301481562781,-0.0283016118821130,-0.0398276660343531,0.0698888406727592,0.0595471146001536,0.224360504039573,0.0429161655615870,0.0312811183236853,-0.154003368634958,0.0507809381601961,0.0541556735143260,0.0910965298583816,0.0141622242400027,-0.0755661712271526,0.156537493181585,0.00477701758379699,-0.0204616545058493,-0.151461857000836,0.0348847180925431,-0.0258014337041755,0.0160132541475817,-0.0207805894012873,-0.0625045793626709,-0.108286837825579,0.121706261544201,-0.0300772046317218,-0.125073448297500,-0.0968219146496621,0.213231855618969,0.0704687711795339,-0.168542454977278,-0.0494145095891210,-0.0718329512236886,0.00926970285878454,-0.173320710847464,-0.0252482173834479,0.0699519579896947,0.0730143250805624,0.141726941105468,0.141770167646339,-0.0575326593093822,-0.204997354037487,0.0353492352212972,0.0285682751925773,0.0309414687116599,-0.0901794832149440,-0.0639155127282365,-0.0988828731580909,-0.0271797235972930,0.246367955128379,-0.108063008720469,0.0858019122237238,-0.0723717688434108,0.0257714160477946,-0.167611220829370,-0.116816302181438,0.0280471670587135,0.0689046769063325,-0.0220999399142625,0.0715920932019082,0.0279294698760322,-0.0237042417998885,-0.271616379329803,-0.0445069787839291,0.0346990804414630,0.0722589134509322,0.00965624504780797,0.0254312274971100,-0.0591417920510131,-0.116967327874777,0.0906879018747968,0.141158517921375,0.0181465417206581,0.0249114941109321,0.0255779221570760,0.0289498189303358,0.0254028394198900,-0.0950382730450028,0.0195579608344487,0.0144104754021897,0.0542161053900680,-0.0209592867792539,0.000429074491299475,0.0405212296231902,0.00479508806060245,0.165930757817179,-0.0266627468598718,-0.168153025859292,-0.124469575122924,-0.0818342120070423,-0.00294830983586233,0.0485458406389747,0.0654292286782731,-0.0391119093146524,-0.00357077620005178,0.174705407913244,-0.0387512136039451,0.0638388404907032,-0.0174742195268590,-0.0734831122476089,-0.117733669860309,0.134966946237867,0.109131249669511,0.00869279729532834,0.0227207690084145,0.00706520857467846,-0.0821977655711723,-0.0693093854888035,-0.162268556121014,-0.0395091504067511,0.0465406226258003,-0.0553645640528344,-0.0116513831806540,-0.103119594277980,0.0279749439210067,-0.0365903253571875,0.0459379776472283,-0.0687394887698751,-0.188088350373675,-0.0562263248798681,0.00689606604104027,0.0388388220885435,-0.138709201362358,0.0153130489306521,0.124321316763907,-0.0362279660814597,0.0553557657734719,0.109009093946057,0.115067442692768,0.0433243607847919,-0.0221459517424050,0.000285150935555424,-0.0353838620352103,0.0113437838136650,0.0769620342579813,0.0466222239320783,0.105441146785139,0.100701398584977,0.0349413388548889,0.0576402345286207,0.0559414781720807,-0.00804044502311456,0.241333563182492,-0.0559239033360961,0.148744378245477,-0.0547677019332364,0.0386185155881800,0.155147061805769,0.0607894090904394,0.0538496641040272,-0.106104952581036,0.209855906314721,0.0124832351231639,0.000470375367664060,0.0230797676608851,-0.192211118616988,0.0273779714790394,-0.0556043220992716,0.0616237663988761,0.0481416306013461,0.0758911187001629,0.228527299677931,-0.106759466656595,-0.0865504273205529,-0.205933108141698,0.0412697954633177,-0.0202963025769831,0.00365694533258722,-0.0834719938638125,-0.0838346669136488,-0.0156297350196975,-0.159573967417323,0.0915681987332840,0.00969254169288902,-0.0230031436402547,0.0220544607972873,0.0526226810543622,-0.163898431964735,-0.118693992932771,-0.0387380069271035,-0.00125158422620446,0.0500893316802494,-0.104026308510651,0.0280943617283598,0.117060241500748,-0.00792158325002381,-0.0421950648398714,-0.0446840722969612,0.0354547437533731,-0.0628726390281285,-0.0253395721868696,0.0539438697425089,-0.0524710144241091,0.0676392855697409,-0.0167850934700781,0.0323162990725570,-0.0593795064880222,-0.127489510047971,-0.0337429480831296,0.0755015299562031,-0.0709602071131654,-0.0376417551866327,-0.0769476111334431,-0.0246480733008850,-0.128962299958015,-0.0223420846455139,-0.0261775688646864,0.142481264464255,0.0502393688055971,-0.0636537859996936,0.0998852604429465,0.0823329142363134,-0.123160969023515,-0.00974692595385984,-0.00171139871992280,-0.0206250420698730,0.113996166248768,0.100687541229563,0.0462266227191433,0.0127822500879422,-0.0479053515619525,0.135569718051667,0.0149201807262241,-0.0121892443835119,0.0172548139503378,-0.0589453644453743,0.257034024784209,-0.102212431561921,-0.128083315295668,-0.0185362154599931,-0.133126967529248,-0.0648919947656968,-0.116830703346403,0.0363709761003918,-0.188452318649792,0.164277959673655,0.214294114538741,0.0997671499252054,0.0530456047071112,-0.0877713091722939,0.0925278200688280,-0.100822921570941,-0.0912330686410026,0.177076385788271,-0.102135331522014,-0.122207599710070,-0.0875515062610162,0.0122018323577909,-0.0188417870621923,0.0902604232825885,-0.118261545600395,-0.105474327095955,0.0821711364141192,0.00543106476445025,-0.0174428134566688,0.00522129017712939,0.0385704998145648,0.0687907988243781,-0.0912975187926686,0.311717225050948,0.0508788976342112,0.115126548445544,0.0379091459835193,0.118603596881285,-0.111867512085144,0.0562273538742890,-0.0439898533932428,0.0216720798265240,-0.0514163614450007,0.105608503059925,0.0498771514208299,-0.00666878806307029,-0.106598932998594,0.00359362039739938,0.0135915417216691,0.0729437603508965,0.125985722216099,0.0245240074554633,0.0300847917568241,0.0356983511930330,-0.0437466016296704,0.0377737545191551,0.0598200707419633,0.0591347598678487,0.0108084085911770,0.241613117534232,-0.136453606336929,0.0547897831914521,0.0785650570688178,0.0165578797257990,0.0729397345090288,-0.0471602312684533,0.0294784714575007,0.0552595426286374,-0.0392999180142289,-0.00272357468067036,0.0817438361238223,0.0598369496389958,0.101236629052380,-0.0534334156504657,0.0847998257595259,-0.0256293540553964,0.0524965616448443,0.0861742394104284,-0.0174972364392812,-0.0966388215091202,0.117663972444087,0.0840567440494355,-0.000841891595405722,0.0216087126172489,-0.103682389145227,-0.0628206988782683,-0.0118863451862397,-0.0772496007924661,0.00267808064799460,0.0571846922641861,-0.141934203516455,-0.163176312724007,0.0358507886849786,-0.129660997590656,-0.0445797662694835,-0.130841728293730,-0.0285752387423106,-0.00993809081452944,-0.0687744001439171,0.124619747817044,-0.0264396523960070,-0.220929630823881,-0.0131991515599824,0.0701077000048879,-0.00942854565023704,0.130153033282916,-0.161763874530414,0.0535689698403174,0.139885225360830,-0.0418286491448695,0.0382774922123989,-0.0582462796034296,-0.0670538008656852,-0.0720194562216614,-0.0790060268866815,0.00769384454974831,-0.0851383949202400,0.105400329118004,-0.0552272451073579,0.0160011325487498,0.0596087178359212,-0.0750266068667130,0.0850542801996720,0.0147996633906621,-0.137161249494890,-0.000493453003973596,0.00611840238286693,-0.00729154594873627,0.121885054581383,-0.177009663636178,0.0345910984420378,0.0161951550208209,-0.0137833704782797,0.0205367685269005,4.40607739321607e-06,0.0758135623948879,-0.0556042928850966,0.00913579506842722,-0.0279105648724947,0.111506383451046,-0.193218838274329,-0.0566312546220854,0.0289629314681923,-0.0383260092403595,-0.0370261612332896,-0.0381841059248209,-0.0609712136116650,0.0714565699867764,-0.152507711302932,0.0686780578436781,-0.103534205254220,0.0366546736717532,0.0754029297816123,-0.0312561172431721,0.0584720955275428,-0.0352080062442723,-0.125453865163855,-0.143702064318002,0.00902513206103730,0.0477618775186100,0.0677520420624441,-0.137584765868588,-0.0940064173458336,-0.146949426044278,-0.0795378915834964,-0.0148102916196524,-0.144642817905441,-0.0794060686804299,-0.0607960807448399,-0.201092466060228,-0.0396954791516612,0.0477751772737113,0.241232140942582,0.193061434016372,-0.00814240074401925,-0.0557301819191344,-0.0159243184619300,-0.0472174246872829,0.00333795942838534,0.0153436029797838,0.0984577767829646,-0.148913050808423,-0.0825223925571247,0.0581135477166766,0.0599625630675590,-0.00504610130250963,-0.0224484167455839,-0.0423261007339592,0.0766395743444504,0.0978635118205100,0.219806027397692,-0.170856701675180,-0.0935308045175742,0.0852266454203017,0.0399231975058195,-0.0910194516377214,0.0244012168031649,0.0376876916571792,-0.00485419211696455,-0.0610904130546596,-0.106406310018527,0.0497773966154876,0.0378852504373662,0.0420220135378186,-0.117295151244119,0.159882378150504,-0.0210630762327947,-0.0148907741692802,-0.0124028051517288,0.0573587994972488,-0.0589284365653394,0.0188304037032701,0.0254760045913217,0.0550123705439170,-0.122441079626503,0.0307981419163795,0.0357312958121235,0.00410427108776842,0.189018680658107,-0.0480433203366661,-0.0644744592852325,-0.173661219534444,0.105734608676696,-0.00809098288827763,0.154208779537285,0.169272727472926,0.0488768383361317,0.171799059394765,0.0561041024977823,0.0312024403456064,0.00153303808783960,0.0138102236142614,0.0293344023324627,-0.144363868405113,0.0839048225156672,-0.127715807716326,0.0268315451885900,0.0715840527750588,-0.0215716127021746,0.0538837544944670,-0.0183661781746123,0.0214387403638763,-0.0321352886387149,0.0400921725543654,-0.140193237802303,0.0365175158956064,-0.0246360345797487,0.0516405037285556,-0.0276284049117952,0.0257905057727074,0.167209186044823,-0.124862142533420,-0.0128492784162189,-0.0164040030246313,-0.147223442961339,-0.0387994930198320,-0.0414201568957407,0.0459672530454647,-0.0115156452154845,0.0839001492053822,-0.0230838231159937,-0.0329519486697893,0.0805330335084751,0.0397197455818466,-0.0224457509618177,0.0100406508391298,-0.0915689827616080,0.103778239610741,-0.127368810834062,-0.0954475935839897,0.0202936900169309,-0.0193158202764541,0.0795338088282873,-0.0318265492863179,0.0763807394580363,0.0777532110105565,-0.140907264882232,0.0572209266814802,0.0274453172121557,0.0308700207977830,-0.0619266629930474,-0.0700873194914791,0.0478304185993205,-0.0806012020170476,0.101410412128621,0.230268947720166,0.0106315993886924,-0.0671974513950743,-0.102576438687097,0.0539032849655827,-0.0374261753230149,-0.0958747038899713,0.00596211143628260,0.0633968716406755,0.0732197816538607,0.141178633992638,0.209058306815237,0.0367226128387557,0.0634134607153055,-0.0855328566927543,-0.0698496411383408,0.0633163568198304,-0.0193737237499366,0.0691492953498896,0.0792618342618878,-0.00889610591267134,0.0132190503647837,-0.0533439615350219,-0.0346300825286938,0.0443484308733990,-0.0177240698229662,-0.142875459061430,0.0335207298005241,-0.0543251171963474,-0.107856246900575,0.0861775831643943,-0.0341392624577230,-0.0991202674713189,-0.0367631837862311,-0.158628697355617,-0.0240831208683375,-0.00177022871362960,0.0162359756642506,0.0271406956590987,0.0391933301926492,-0.0208998299521686,0.0525542705526139,0.00889481555266400,-0.126275735737782,-0.0799672550233390,0.165981425159078,0.0112206415831765,0.0355183711049188,0.0176060258307998,0.0388906877759943,0.0478476562983705,-0.0265263158974448,0.0623920104899962,0.0100249565592967,0.180212902921885,0.00974206196255381,-0.0376208810487335,-0.0220519261651762,-0.0644569610128229,-0.144120992059639,-0.137047412430566,-0.136195588033416,0.0576909499704549,0.0528442670177630,0.0859466028571298,-0.0916448746376837,-0.0613057551558573,0.210135505311765,-0.0572678377872106,0.0319600920317598,0.0200481544174285,-0.0165392757695834,-0.115333680273688,0.0192455328331128,0.00993836022943589,-0.0426235763908033,-0.0578739369073165,0.202217390157794,0.0178589839251774,0.0710094512845824,-0.0888807710180838,-0.0777611263775785,0.215365665316059,0.0364431965060378,-0.143635347297842,-0.171872742375931,-0.0704476280317250,-0.131228962025433,0.00734192021755617,0.0120863254774994,0.00165943395683783,-0.199129952401241,-0.00120589889409688,-0.0332549794810813,0.0256077822974256,0.116337106659670,0.0217832655332446,-0.00744447379729225,0.0742794044790280,0.0970879369914109,-0.00307335883999514,-0.0420863783667222,0.0119478897756280,0.0346388816246782,0.178870693617804,0.0309537031032716,0.0730149622066055,-0.00184357036452477,-0.0413405191139428,0.0831473078377922,-0.0580548746688163,0.129948661924642,-0.134441024523961,-0.0545237601750639,0.0344065965530396,0.0909839344186276,0.125144559678521,0.0352106337370935,0.0816648624782799,0.0695675230123357,0.0926823207996331,0.0445251047242849,0.0288888695331262,0.129048152979517,0.0151662344211913,-0.0179554559709633,-0.0649010232725019,-0.113250333363945,0.0227141232892221,-0.0757579390493091,0.113265933339042,0.134887509488513,0.231341908118421,-0.0311029086508356,0.0971325363901107,0.0257853077113108,-0.0889070945954051,-0.168755002078589,-0.0272788480076823,0.0572268771781476,-0.0261937379271519,0.0147367826707451,-0.0307483592242386,-0.116664018918035,0.0383593596450868,-0.0283553642130580,0.0267292918643647,0.0483943604591363,-0.133857360072342,0.134694551717792,0.0318771601306556,-0.0304610259494315,0.0139475090760494,-0.0780777460100176,-0.0376499675888243,-0.103268587550056,0.0364260309681460,0.00463412582902661,0.103008509649752,-0.0703981569496294,0.137977501393576,0.00788883216458142,-0.0784916884157567,-0.0245606409969440,-0.0705483603926834,0.0761926658826569,0.0455417722288924,-0.110545442012991,-0.199612175857178,0.110507640215159,0.0473900383745994,-0.0495562526273764,-0.0110388160729361,0.0695921925163530,-0.130938416144601,-0.0288865696703458,-0.0639605594711944,0.0242923694680952,0.0663998886621257,-0.0304998110564971,-0.141820488723131,0.0781326379687080,0.0235923920631135,-0.000196821962845866,0.0583988076435294,-0.0789008664627643,-0.0455095367688392,0.181199889772821,-0.00549237456577018,-0.0441910998347012,0.0477856654927038,-0.194742885798022,-0.0861115044138154,-0.0150149090423623,-0.0715713694442820,0.0148940995105696,0.0486975973258328,0.0238242578016970,0.0130097706234401,0.0873007017990887,0.0698872054038050,-0.0474487937651628,0.0403633882874151,-0.0914310915229070,-0.132310186052777,-0.190608654261620,0.114028745770773,-0.0242047742038900,0.0459746326919776,-0.0693331716851306,0.00515479552030807,0.0130668952238098,0.0907031847819200,0.0482432588847810,0.166620138525812,-0.117018739332798,-0.0466639664922322,0.00729539060792158,-0.179784309039509,0.106239755231285,-0.0828331042333026,-0.172704971211152,-0.0803189879251728,0.0119714390641892,-0.105767416110296,0.128706444982741,0.00884704013262356,0.0620080902938446,0.0900399088610059,-0.120357924282117,0.0231052730480762,-0.0837886995600512,0.197057019867266,0.0821825539027411,0.0793628743453703,0.192490261648475,0.130722697304491,-0.0774170787620407,0.0137434154254413,0.0717998881369173,-0.0524364150856493,0.0531304154179185,0.157177100634206,0.0895198832773413,0.0909386227419904,0.0159326797224113,0.0567154003021519,0.00822972945318139,0.221746253530417,0.168690251346805,-0.0792353939986105,0.0106508488980604,0.105980092858108,0.0338548507604911,0.0862529633558612,-0.0504915183065178,-0.101325253871468,-0.0169412425698881,-0.109320330547126,-0.0266231474278065,0.0260041775402909,-0.226667441215337,0.202910107964939,0.0347308373653798,-0.0103035471233253,-0.0266961357960981,-0.0243157078505563,0.118401017493452,-0.0799768216945750,0.149323213301657,0.118542369993028,0.0240298679806873,-0.0965416881157627,-0.0322584347980876,-0.0507467522647619,-0.0320201952698410,-0.0670096349067983,0.177654170133698,-0.0271194746338332,-0.0508087114748081,0.0639101405073047,-0.0533755044253279,-0.117428564820775,-0.0584015922989113,0.0738181504749200,0.0499765900112184,0.0212640300261440,0.0369292200029802,-0.0214204986821033,0.0193971338980295,-0.0481300123685714,-0.181356652427033,-0.0117748728915624,0.0402193106252620,-0.0832163716291540,-0.0655051430754924,0.0298366977232441,0.0211922781181869,-0.0116617701380958,0.100627074440866,-0.0760860764694624,0.0282797753195640,0.0723504029288410,0.0482193883265660,0.0354734559278079,0.00815894728481342,0.108104478018287,0.0556258440800284,0.128867363057199,0.0486891209992640,0.0376079475322770,-0.0334246773835203,0.0939974402855132,0.0108037696495234,-0.106354886775012,-0.0874957671315304,0.0708612980791593,0.0364191262439477,-0.0138655167526305,0.0189147951563062,0.0484049509079722,-0.0765279755809186,0.0189757804128544,-0.0617528965650742,-0.0687523280561089,0.0411769605095120,0.243294042607028,0.0171960744828725,0.0488867012905556,0.160299527875150,0.0391687313513118,-0.0856607146910136,-0.0357249389152524,0.113338676456763,-0.0513357480840664,0.131659173286969,-0.0199575985029848,0.0103653521216382,-0.0172545015693682,0.00540417803994932,0.183701461753177,0.125217178875096,-0.0895129975310274,-0.0654698437453750,-0.0751249382243022,-0.0325912820002523,-0.0282741612875980,0.0289524023067950,0.0967444459973374,0.00687612398774982,-0.0578100748530258,0.0724678071772197,0.0888151010371768,-0.0101538104795284,0.0268277015159610,-0.0312762166186433,-0.0631561405220293,-0.0750160197259650,-0.0143487586602037,-0.0448851541759046,0.0883937233913058,-0.0610198771846716,-0.0130108934806369,-0.220695672281866,0.0693555492753091,-0.0493467093394710,-0.0258613814259621,-0.0929520421721328,0.0832736073517790,0.152897822294749,-0.113424886695633,-0.0188280511788128,0.00419591182494125,0.0603660838683640,-0.116206238087614,-0.131051291554140,0.102258393296169,0.0925455403939292,0.0917308095376833,0.105869041474982,0.0930998513214359,0.0358408165238504,0.0245542230249527,0.0832951399964873,0.138335187372281,0.0159686042469981,0.177728794030185,0.0736072151631584,-0.0941274115543636,0.163833188972491,0.0122256751469215,0.0247297300003312,-0.0849098069660671,0.0808622347767904,-0.0119116668716490,0.0184480271248749,-0.0641521006232473,-0.0514977882273999,0.0773517898282616,0.127026564712957,-0.0357903667560043,0.0154095970200332,-0.00446637612504278,0.0191542455367156,-0.196397724531235,0.00101475705826874,-0.0210846432893747,-0.104740357646206,-0.0703910703466218,-0.0740844986989368,0.0729584348605911,0.133300860569361,0.0283886342835945,0.00713304462754757,0.112691124967655,-0.0755148834881750,-0.169716747192106,0.00606365892220530,-0.0530618728763963,-0.0727954521040345,0.119446755106685,-0.0296001031840354,-0.0129095277949430,-0.0283351393249177,-0.147092748159138,-0.0575897497985518,0.0890754260988668,0.0390081582681056,0.0272786893860863,-0.0275267317144366,-0.0477992177840761,0.0351314510030885,0.0265594581672928,-0.0537893869895029,-0.205852441442373,-0.0765175546495835,0.154348745177156,0.103468165203359,-0.0368058996514539,-0.00387305235610648,0.00468271100765650,-0.0200571014662698,-0.0747716111310477,-0.0523839038474816,-0.0661919787495285,-0.0321539794766375,0.0565258777144789,0.00828424125257680,-0.149671848224900,0.111946359205410,0.00225871414440295,-0.0613950106885938,-0.156307194274074,0.0918610674776068,-0.168562431014044,0.00452727872996255,-0.144409094147988,-0.00504527016226371,-0.00162000194192126,-0.0546764445465478,-0.0765871796535474,0.0196765261057924,0.123341509732021,-0.00243610630086247,0.0466566038419076,-0.0190615140086495,-0.155190054692159,-0.123577729905558,0.0396654764930980,-0.0830010178505836,-0.0427812694064718,-0.182509566749575,0.0641113893992475,-0.0249675021619644,-0.0202668125389275,-0.0785691939951414,0.00133579882718445,0.0702429101393922,-0.0487188273398950,0.0315827995937124,0.0552821189901547,0.0664233886737966,0.0433072251435429,-0.139393464392398,-0.0198671422436555,0.0488596065555476,-0.0470236065262386,0.00110211796271195,-0.0521521801854952,0.105367914564729,-0.187706397297254,-0.123579096627471,-0.0206705027047620,-0.0503822346751585,-0.0272803400677867,-0.0664587335575566,-0.0329750990724643,-0.0651474953384159,0.0797202320558860,-0.0921986191734771,0.0137344456254220,0.0420605310204911,0.108248133217789,0.0849257528394279,-0.113878309933114,-0.0143632781031151,-0.0152835689795865,-0.0415256733251182,-0.0827603519394231,-0.0529686654111445,-0.00715751294704793,-0.0991992786122034,-0.0397214900755643,-0.0222004382966838,0.0272500777507680,-0.0408250745699849,-0.0373811589662559,0.0805126435368419,-0.0322611275874954,-0.0684537916112045,0.0672812351436437,0.115732350532711,0.0407284158902062,0.0452562167199553,-0.0372863398840289,0.0688944277583556,0.0283713533879629,0.0816647622845716,-0.0890037837023590,-0.0134890765161851,-0.0227474151031070,0.0158100567114940,5.53413062710728e-05,-0.153699239128399,-0.0289334413837585,0.0499447031274952,0.149070879555801,0.315534714120898,0.0231799160565672,-0.0847895834146406,-0.102927571566923,0.0922499405541846,-0.00772592543723668,0.242932417440475,0.0665529271723910,-0.0609373184738711,0.0653510848074989,0.0448990400408079,-0.0520633027423022,0.0918435059201145,0.148678357305575,-0.267743979940439,-0.0245776319754271,-0.142467024744579,-0.0445995586291877,-0.0225439059088091,-0.0934240745247218,-0.0906628994127573,-0.0969260699640507,0.134020325588379,0.0720796817564883,-0.154668940475588,-0.162249070134688,-0.0238709361013087,-0.109346964770539,0.124824913649775,-0.00385233591180502,0.153640597401756,-0.0328116326782632,0.0609925470432377,-0.106830758000231,0.0783454317523059,-0.112172482876183,-0.0521127967430786,0.0478066182996027,0.0270607837028589,-0.00745043703052671,-0.0180816087564474,-0.0829301206330332,0.0781014586684922,-0.0930819836205500,-0.0211894523022969,-0.0749630425470946,0.0695423353424296,0.105474447375956,-0.0923424753698911,0.120412812868968,0.00100357642251777,-0.0833207187868775,0.0340036299874826,0.143488093100994,-0.0283974454525343,0.0962572767985019,0.00297764608895116,0.0662507687411592,0.0819876363518506,-0.0668427429593522,0.00150003613497597,0.0420302488814148,0.176789278844553,-0.0341527421828060,0.301186155423062,-0.0793709281800376,-0.0435506451575039,0.0437381560137197,0.0709037755480017,-0.0307432632094908,-0.133729536487878,0.0188694700364484,0.0398466678335288,0.151310932497083,0.0249241054509987,-0.0259643951195822,-0.0987862364816541,-0.0774042698942262,-0.0403947689577288,0.0373631414719949,-0.00216215015952670,-0.112305743949712,0.0145314043872954,-0.0251147494786225,-0.0803225208565230,-0.0435763229502237,-0.00287849993637392,0.0706123011944673,0.0804760507775867,0.00590053309600970,-0.0387265904580678,-0.193879334882231,0.00199832657095831,0.0514794311255441,-0.0380252189160349,-0.0669799753605831,0.0491224227194802,-0.0262625468936262,-0.122437289349919,0.0440156844319808,0.0754430639733271,-0.111596020415521,-0.103620741833545,-0.176069339048467,-0.194588883586123,0.147981181584214,0.0385323859283492,0.0572540157835828,0.0159981212003724,-0.0675952862485155,0.124530957388545,0.144254840582761,-0.0307827279062844,0.0399404463550796,-0.00388808199103310,0.118606884504613,0.0615507216705999,0.0939067246786548,0.0584357362760181,0.157762126519483,0.0405068069007540,-0.0504489141691223,-0.00973844568462643,0.0357376032952380,0.0193711101539528,-0.0114909175142723,0.196516263472175,-0.0446430464155759,0.101374174518291,-0.190680421565876,0.0389842622526612,-0.107466882758501,-0.0414386109450934,0.0878547060183486,0.0383586896208739,-0.0680797170032876,-0.138329943536831);
//	cv::Mat y = (cv::Mat_<float>(26,1) << 0.532902749146375,0.0490411907646296,0.715367047709373,-0.119946441313002,0.270925571240465,-0.121101954141428,0.214023461076829,0.304894412279703,0.202505160965137,-0.253285287942033,0.0190365247056839,0.893026226521118,-0.0932523720984676,0.124624337525522,0.146811747037399,0.289835792413863,-0.477417858903505,-0.0276400901828772,0.166348806008609,0.347924069377288,-0.149474178340000,0.172796489877381,0.0831123055672387,-0.475272763870440,-0.248822768696722,0.00737541464411715);
//
//	SpaRSA_noSI solver = SpaRSA_noSI(y, phi);
//	solver.runAlgorithm();
//
//	std::cout << "FINISHED\n\n" << solver.reconstructed();
	Options::parseOptionsFile("/Users/sohamghosh/src/imcompress/input/options");
	std::cout << "Average measurement rate: " << (Options::Mk + Options::Mw * (Options::M * Options::M - 1))/(Options::M * Options::M) << "\n";
	cv::Mat inputImage = cv::imread("/Users/sohamghosh/src/imcompress/photos/photo.jpg");
	cv::cvtColor(inputImage, inputImage, CV_RGB2GRAY, 0); // ensure only 1 channel
	clock_t startTime = clock();
	Encoder e(inputImage);
	std::cout << "Encoding image: " << double( clock() - startTime ) / (double)CLOCKS_PER_SEC << "s" << std::endl;
	e.encodeImage();
	Decoder d(inputImage.rows, inputImage.cols, e.getKeyPhi(), e.getnonkeyPhi(), e.getEncodedValues());
	startTime = clock();
	d.decodeImage();
	std::cout << "Decoding image: " << double( clock() - startTime ) / (double)CLOCKS_PER_SEC << "s" << std::endl;
	std::cout << "PSNR: " << cv::PSNR(inputImage, d.getDecodedImage());
	cv::imshow("Output", d.getDecodedImage());
	cv::imwrite("/Users/sohamghosh/src/imcompress/photos/output.jpg", d.getDecodedImage());
	cv::waitKey(0);
	return 0;
}
